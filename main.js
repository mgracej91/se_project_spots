!function(){"use strict";var e="",t=e+"ad8dae02f0c7eb97bc8d.svg",r=e+"2fc47fd8e9a9bcd9612f.jpg",o=e+"d38272e02bb4f1ab1c37.svg",n=e+"40608da7369d39bc1077.svg",a=e+"d73f076c46eb5467f5fc.svg";const c={formSelector:".modal__form--validate",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",modalButtonSelector:".modal__close-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_error_type",errorClass:"modal__error_visible"},s=(e,t,r)=>{const o=t.id+"-error",n=e.querySelector("#"+o);n.textContent="",t.classList.remove(r.inputErrorClass),n.classList.remove(r.errorClass)},l=e=>e.some((e=>!e.validity.valid)),i=(e,t,r)=>{console.log(l(e)),l(e)?d(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},d=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)};document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".header__logo"),c=document.querySelector(".profile__avatar"),s=document.querySelector(".profile__edit-button img"),l=document.querySelector(".profile__newpost-button img"),i=document.querySelector(".profile__avatar-edit");e.src=t,c.src=r,s.src=o,l.src=n,i.src=a}));const u=new class{constructor(e,t){this._baseUrl=e,this._headers=t}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this.checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this.checkResponse)}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then(this.checkResponse)}newCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then(this.checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{...this._headers,"Content-Type":"application/json"}}).then(this.checkResponse)}likeStatus(e,t){const r=t?"DELETE":"PUT";return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:r,headers:this._headers}).then(this.checkResponse)}newAvatar(e){return console.log("Sending to API:",e),fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this.checkResponse)}checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}}("https://around-api.en.tripleten-services.com/v1",{authorization:"f6c1a9da-fc55-44bb-a3ff-1c31fae8dd86"});u.getAppInfo().then((([e,t])=>{k.textContent=t.name,E.textContent=t.about,p.src=t.avatar,console.log([e]),e.forEach((e=>{const t=V(e);x.append(t)}))})).catch((e=>{console.error(e)}));const m=document.querySelector(".profile__edit-button"),_=document.querySelector("#edit-modal"),h=_.querySelector(".modal__form--validate"),v=_.querySelector(".modal__close-button"),p=document.querySelector(".profile__avatar"),f=document.querySelector("#avatar-modal"),y=f.querySelector("#edit-avatar-form"),S=f.querySelector("#profile-avatar-input"),b=document.querySelector(".profile__avatar-btn"),q=f.querySelector(".modal__close-button"),k=document.querySelector(".profile__title"),C=_.querySelector("#profile-title-input"),E=document.querySelector(".profile__description"),L=_.querySelector("#profile-description-input"),g=document.querySelector("#card-template"),x=document.querySelector(".cards__list"),A=document.querySelector("#post-modal"),U=document.querySelector(".profile__newpost-button"),w=A.querySelector(".modal__close-button"),T=A.querySelector(".modal__form--validate"),$=A.querySelector(".modal__save-button"),D=A.querySelector("#post-link-input"),I=A.querySelector("#post-caption-input"),R=document.querySelector("#preview-modal"),j=R.querySelector(".modal__image"),B=R.querySelector(".modal__caption"),P=R.querySelector(".modal__close-button_type_preview"),O=document.querySelectorAll(".modal"),N=document.querySelector("#delete-modal"),J=document.querySelector("#delete-form"),H=N.querySelector(".modal__button-delete"),M=N.querySelector(".modal__button-cancel"),z=N.querySelector(".modal__close-button");let F,G;function K(e){e.classList.add("modal_opened"),document.addEventListener("keydown",X)}function Q(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",X)}function V(e){const t=g.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__image"),o=t.querySelector(".card__title"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.src=e.link,r.alt=e.name,o.textContent=e.name,e.isLiked&&n.classList.add("card__like-button_liked"),n.addEventListener("click",(t=>function(e,t){let r=e.target.classList.contains("card__like-button_liked");u.likeStatus(t,r).then((()=>{if(r)return e.target.classList.remove("card__like-button_liked");e.target.classList.add("card__like-button_liked")})).catch((e=>{console.error(e)}))}(t,e._id))),a.addEventListener("click",(()=>{!function(e,t){F=e,G=t,K(N)}(t,e._id)})),r.addEventListener("click",(()=>{K(R),j.src=e.link,j.alt=e.name,B.textContent=e.name})),t}J.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;t.textContent="Deleting...",u.deleteCard(G).then((()=>{F.remove(),Q(N)})).catch(console.error).finally((()=>{t.textContent="Delete"}))})),h.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;t.textContent="Saving...",console.log(t),u.editUserInfo({name:C.value,about:E.textContent=L.value}).then((e=>{k.textContent=e.name,E.textContent=e.about,Q(_)})).catch(console.error).finally((()=>{t.textContent="Save"}))})),m.addEventListener("click",(()=>{!function(e,t){const r=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);r.forEach((r=>{s(e,r,t)})),i(r,o,t)}(h,c),C.value=k.textContent,L.value=E.textContent,K(_)})),v.addEventListener("click",(()=>{Q(_)}));const W=e=>{e.target.classList.contains("modal")&&Q(e.target)};function X(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&Q(e)}}var Y;O.forEach((e=>{e.addEventListener("click",W)})),b.addEventListener("click",(()=>{K(f)})),q.addEventListener("click",(()=>{Q(f)})),U.addEventListener("click",(()=>{K(A)})),P.addEventListener("click",(()=>{Q(R)})),w.addEventListener("click",(()=>{Q(A)})),H.addEventListener("click",(()=>{Q(N)})),M.addEventListener("click",(()=>{Q(N)})),z.addEventListener("click",(()=>{Q(N)})),T.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;t.textContent="Saving...",u.newCard({link:D.value,name:I.value}).then((e=>{const t=V(e);x.prepend(t),T.reset(),d($,c),Q(A)})).catch((e=>{console.error(e)})).finally((()=>{t.textContent="Save"}))})),y.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;t.textContent="Saving...";const r=S.value;u.newAvatar(r).then((e=>{S.value="",p.src=e.avatar,Q(f)})).catch((e=>{console.error(e)})).finally((()=>{t.textContent="Save"}))})),Y=c,document.querySelectorAll(Y.formSelector).forEach((e=>{((e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);i(r,o,t),r.forEach((n=>{n.addEventListener("input",(()=>{((e,t,r)=>{t.validity.valid?s(e,t,r):((e,t,r,o)=>{const n=t.id+"-error";e.querySelector("#"+n).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,r)})(e,n,t),i(r,o,t)}))}))})(e,Y)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQ0EsSUFBSUEsRUNEb0IsRywySkNBakIsTUFBTUMsRUFBVyxDQUN0QkMsYUFBYyx5QkFDZEMsY0FBZSxnQkFDZkMscUJBQXNCLHNCQUN0QkMsb0JBQXFCLHVCQUNyQkMsb0JBQXFCLDhCQUNyQkMsZ0JBQWlCLDBCQUNqQkMsV0FBWSx3QkFVUkMsRUFBaUJBLENBQUNDLEVBQWFDLEVBQWNDLEtBQ2pELE1BQU1DLEVBQWFGLEVBQWFHLEdBQUssU0FDL0JDLEVBQWtCTCxFQUFZTSxjQUFjLElBQU1ILEdBQ3hERSxFQUFnQkUsWUFBYyxHQUM5Qk4sRUFBYU8sVUFBVUMsT0FBT1AsRUFBT0wsaUJBQ3JDUSxFQUFnQkcsVUFBVUMsT0FBT1AsRUFBT0osV0FBVyxFQWdCL0NZLEVBQW1CQyxHQUNoQkEsRUFBVUMsTUFBTVgsSUFDYkEsRUFBYVksU0FBU0MsUUFJNUJDLEVBQW9CQSxDQUFDSixFQUFXSyxFQUFlZCxLQUNuRGUsUUFBUUMsSUFBSVIsRUFBZ0JDLElBQ3hCRCxFQUFnQkMsR0FDbEJRLEVBQWVILEVBQWVkLElBRTlCYyxFQUFjSSxVQUFXLEVBQ3pCSixFQUFjUixVQUFVQyxPQUFPUCxFQUFPTixxQkFDeEMsRUFHV3VCLEVBQWlCQSxDQUFDSCxFQUFlZCxLQUM1Q2MsRUFBY0ksVUFBVyxFQUN6QkosRUFBY1IsVUFBVWEsSUFBSW5CLEVBQU9OLG9CQUFvQixFQ3pDekQwQixTQUFTQyxpQkFBaUIsb0JBQW9CLEtBQzVDLE1BQU1DLEVBQWFGLFNBQVNoQixjQUFjLGlCQUNwQ21CLEVBQWdCSCxTQUFTaEIsY0FBYyxvQkFDdkNvQixFQUFrQkosU0FBU2hCLGNBQWMsNkJBQ3pDcUIsRUFBcUJMLFNBQVNoQixjQUNsQyxnQ0FFSXNCLEVBQWFOLFNBQVNoQixjQUFjLHlCQUUxQ2tCLEVBQVdLLElBQU1DLEVBQ2pCTCxFQUFjSSxJQUFNRSxFQUNwQkwsRUFBZ0JHLElBQU1HLEVBQ3RCTCxFQUFtQkUsSUFBTUksRUFDekJMLEVBQVdDLElBQU1LLENBQUcsSUFHdEIsTUFBTUMsRUFBTSxJQy9CWixNQUNFQyxXQUFBQSxDQUFZQyxFQUFTQyxHQUNuQkMsS0FBS0MsU0FBV0gsRUFDaEJFLEtBQUtFLFNBQVdILENBQ2xCLENBRUFJLFVBQUFBLEdBQ0UsT0FBT0MsUUFBUUMsSUFBSSxDQUFDTCxLQUFLTSxrQkFBbUJOLEtBQUtPLGVBQ25ELENBRUFELGVBQUFBLEdBQ0UsT0FBT0UsTUFBTSxHQUFHUixLQUFLQyxpQkFBa0IsQ0FDckNGLFFBQVNDLEtBQUtFLFdBQ2JPLEtBQUtULEtBQUtVLGNBQ2YsQ0FFQUgsV0FBQUEsR0FDRSxPQUFPQyxNQUFNLEdBQUdSLEtBQUtDLG9CQUFxQixDQUN4Q0YsUUFBU0MsS0FBS0UsV0FDYk8sS0FBS1QsS0FBS1UsY0FDZixDQUNBQyxZQUFBQSxFQUFhLEtBQUVDLEVBQUksTUFBRUMsSUFDbkIsT0FBT0wsTUFBTSxHQUFHUixLQUFLQyxvQkFBcUIsQ0FDeENhLE9BQVEsUUFDUmYsUUFBUyxJQUFLQyxLQUFLRSxTQUFVLGVBQWdCLG9CQUM3Q2EsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQkwsT0FDQUMsWUFFREosS0FBS1QsS0FBS1UsY0FDZixDQUNBUSxPQUFBQSxFQUFRLEtBQUVOLEVBQUksS0FBRU8sSUFDZCxPQUFPWCxNQUFNLEdBQUdSLEtBQUtDLGlCQUFrQixDQUNyQ2EsT0FBUSxPQUNSZixRQUFTLElBQUtDLEtBQUtFLFNBQVUsZUFBZ0Isb0JBQzdDYSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CTCxPQUNBTyxXQUVEVixLQUFLVCxLQUFLVSxjQUNmLENBRUFVLFVBQUFBLENBQVd2RCxHQUNULE9BQU8yQyxNQUFNLEdBQUdSLEtBQUtDLGtCQUFrQnBDLElBQU0sQ0FDM0NpRCxPQUFRLFNBQ1JmLFFBQVMsSUFBS0MsS0FBS0UsU0FBVSxlQUFnQixzQkFDNUNPLEtBQUtULEtBQUtVLGNBQ2YsQ0FFQVcsVUFBQUEsQ0FBV3hELEVBQUl5RCxHQUNiLE1BQU1SLEVBQVNRLEVBQVUsU0FBVyxNQUNwQyxPQUFPZCxNQUFNLEdBQUdSLEtBQUtDLGtCQUFrQnBDLFVBQVksQ0FDakRpRCxPQUFRQSxFQUNSZixRQUFTQyxLQUFLRSxXQUNiTyxLQUFLVCxLQUFLVSxjQUNmLENBRUFhLFNBQUFBLENBQVUvQixHQUVSLE9BREFkLFFBQVFDLElBQUksa0JBQW1CYSxHQUN4QmdCLE1BQU0sR0FBR1IsS0FBS0MsMkJBQTRCLENBQy9DYSxPQUFRLFFBQ1JmLFFBQVMsSUFBS0MsS0FBS0UsU0FBVSxlQUFnQixvQkFDN0NhLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJ6QixhQUVEaUIsS0FBS1QsS0FBS1UsY0FDZixDQUVBQSxhQUFBQSxDQUFjYyxHQUNaLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU50QixRQUFRdUIsT0FBTyxVQUFVSCxFQUFJSSxTQUN0QyxHRDFDa0Isa0RBQW1ELENBQ3JFQyxjQUFlLHlDQUdqQmpDLEVBQ0dPLGFBQ0FNLE1BQUssRUFBRXFCLEVBQU9DLE1BQ2JDLEVBQWFoRSxZQUFjK0QsRUFBU25CLEtBQ3BDcUIsRUFBbUJqRSxZQUFjK0QsRUFBU2xCLE1BQzFDM0IsRUFBY0ksSUFBTXlDLEVBQVN2QyxPQUM3QmQsUUFBUUMsSUFBSSxDQUFDbUQsSUFDYkEsRUFBTUksU0FBU0MsSUFDYixNQUFNQyxFQUFjQyxFQUFlRixHQUNuQ0csRUFBVUMsT0FBT0gsRUFBWSxHQUM3QixJQUVISSxPQUFPQyxJQUNOL0QsUUFBUWdFLE1BQU1ELEVBQUksSUFHdEIsTUFBTUUsRUFBb0I1RCxTQUFTaEIsY0FBYyx5QkFFM0M2RSxFQUFZN0QsU0FBU2hCLGNBQWMsZUFFbkM4RSxFQUFnQkQsRUFBVTdFLGNBQWMsMEJBRXhDK0UsRUFBdUJGLEVBQVU3RSxjQUFjLHdCQUUvQ21CLEVBQWdCSCxTQUFTaEIsY0FBYyxvQkFFdkNnRixFQUFjaEUsU0FBU2hCLGNBQWMsaUJBRXJDaUYsRUFBYUQsRUFBWWhGLGNBQWMscUJBRXZDa0YsRUFBY0YsRUFBWWhGLGNBQWMseUJBRXhDbUYsRUFBb0JuRSxTQUFTaEIsY0FBYyx3QkFFM0NvRixFQUFvQkosRUFBWWhGLGNBQWMsd0JBRTlDaUUsRUFBZWpELFNBQVNoQixjQUFjLG1CQUV0Q3FGLEVBQXNCUixFQUFVN0UsY0FBYyx3QkFFOUNrRSxFQUFxQmxELFNBQVNoQixjQUFjLHlCQUU1Q3NGLEVBQTRCVCxFQUFVN0UsY0FDMUMsOEJBR0l1RixFQUFldkUsU0FBU2hCLGNBQWMsa0JBRXRDdUUsRUFBWXZELFNBQVNoQixjQUFjLGdCQUVuQ3dGLEVBQVl4RSxTQUFTaEIsY0FBYyxlQUVuQ3lGLEVBQWdCekUsU0FBU2hCLGNBQWMsNEJBRXZDMEYsRUFBdUJGLEVBQVV4RixjQUFjLHdCQUUvQzJGLEVBQWdCSCxFQUFVeEYsY0FBYywwQkFFeEM0RixFQUFtQkosRUFBVXhGLGNBQWMsdUJBRTNDNkYsRUFBZ0JMLEVBQVV4RixjQUFjLG9CQUV4QzhGLEVBQW1CTixFQUFVeEYsY0FBYyx1QkFFM0MrRixFQUFlL0UsU0FBU2hCLGNBQWMsa0JBRXRDZ0csRUFBc0JELEVBQWEvRixjQUFjLGlCQUVqRGlHLEVBQXdCRixFQUFhL0YsY0FBYyxtQkFFbkRrRyxFQUFvQkgsRUFBYS9GLGNBQ3JDLHFDQUdJbUcsRUFBb0JuRixTQUFTb0YsaUJBQWlCLFVBRTlDQyxFQUFjckYsU0FBU2hCLGNBQWMsaUJBRXJDc0csRUFBYXRGLFNBQVNoQixjQUFjLGdCQUVwQ3VHLEVBQVlGLEVBQVlyRyxjQUFjLHlCQUV0Q3dHLEVBQVlILEVBQVlyRyxjQUFjLHlCQUV0Q3lHLEVBQW1CSixFQUFZckcsY0FBYyx3QkFFbkQsSUFBSTBHLEVBQWNDLEVBRWxCLFNBQVNDLEVBQVVDLEdBQ2pCQSxFQUFNM0csVUFBVWEsSUFBSSxnQkFDcEJDLFNBQVNDLGlCQUFpQixVQUFXNkYsRUFDdkMsQ0FFQSxTQUFTQyxFQUFXRixHQUNsQkEsRUFBTTNHLFVBQVVDLE9BQU8sZ0JBQ3ZCYSxTQUFTZ0csb0JBQW9CLFVBQVdGLEVBQzFDLENBZ0RBLFNBQVN4QyxFQUFlMkMsR0FDdEIsTUFBTTVDLEVBQWNrQixFQUFhMkIsUUFDOUJsSCxjQUFjLFNBQ2RtSCxXQUFVLEdBRVBDLEVBQWMvQyxFQUFZckUsY0FBYyxnQkFDeENxSCxFQUFhaEQsRUFBWXJFLGNBQWMsZ0JBQ3ZDc0gsRUFBaUJqRCxFQUFZckUsY0FBYyxzQkFDM0N1SCxFQUFtQmxELEVBQVlyRSxjQUFjLHdCQXVCbkQsT0FyQkFvSCxFQUFZN0YsSUFBTTBGLEVBQUs3RCxLQUN2QmdFLEVBQVlJLElBQU1QLEVBQUtwRSxLQUN2QndFLEVBQVdwSCxZQUFjZ0gsRUFBS3BFLEtBRTFCb0UsRUFBSzFELFNBQ1ArRCxFQUFlcEgsVUFBVWEsSUFBSSwyQkFHL0J1RyxFQUFlckcsaUJBQWlCLFNBQVV3RyxHQWdCNUMsU0FBb0JBLEVBQUszSCxHQUN2QixJQUFJeUQsRUFBVWtFLEVBQUlDLE9BQU94SCxVQUFVeUgsU0FBUywyQkFFNUM5RixFQUNHeUIsV0FBV3hELEVBQUl5RCxHQUNmYixNQUFLLEtBQ0osR0FBSWEsRUFDRixPQUFPa0UsRUFBSUMsT0FBT3hILFVBQVVDLE9BQU8sMkJBRW5Dc0gsRUFBSUMsT0FBT3hILFVBQVVhLElBQUksMEJBQzNCLElBRUQwRCxPQUFPQyxJQUNOL0QsUUFBUWdFLE1BQU1ELEVBQUksR0FFeEIsQ0EvQm9Ea0QsQ0FBV0gsRUFBS1IsRUFBS1ksT0FFdkVOLEVBQWlCdEcsaUJBQWlCLFNBQVMsTUE3QzdDLFNBQTBCb0QsRUFBYXlELEdBQ3JDcEIsRUFBZXJDLEVBQ2ZzQyxFQUFpQm1CLEVBQ2pCbEIsRUFBVVAsRUFDWixDQTBDSTBCLENBQWlCMUQsRUFBYTRDLEVBQUtZLElBQUksSUFHekNULEVBQVluRyxpQkFBaUIsU0FBUyxLQUNwQzJGLEVBQVViLEdBQ1ZDLEVBQW9CekUsSUFBTTBGLEVBQUs3RCxLQUMvQjRDLEVBQW9Cd0IsSUFBTVAsRUFBS3BFLEtBQy9Cb0QsRUFBc0JoRyxZQUFjZ0gsRUFBS3BFLElBQUksSUFHeEN3QixDQUNULENBbENBaUMsRUFBV3JGLGlCQUFpQixVQWpCNUIsU0FBNEJ3RyxHQUMxQkEsRUFBSU8saUJBQ0osTUFBTUMsRUFBWVIsRUFBSVMsVUFDdEJELEVBQVVoSSxZQUFjLGNBQ3hCNEIsRUFDR3dCLFdBQVdzRCxHQUNYakUsTUFBSyxLQUNKZ0UsRUFBYXZHLFNBQ2I0RyxFQUFXVixFQUFZLElBRXhCNUIsTUFBTTlELFFBQVFnRSxPQUVkd0QsU0FBUSxLQUNQRixFQUFVaEksWUFBYyxRQUFRLEdBRXRDLElBZ0dBNkUsRUFBYzdELGlCQUFpQixVQTFJL0IsU0FBbUN3RyxHQUNqQ0EsRUFBSU8saUJBQ0osTUFBTUMsRUFBWVIsRUFBSVMsVUFDdEJELEVBQVVoSSxZQUFjLFlBQ3hCVSxRQUFRQyxJQUFJcUgsR0FDWnBHLEVBQ0dlLGFBQWEsQ0FDWkMsS0FBTXdDLEVBQW9CK0MsTUFDMUJ0RixNQUFRb0IsRUFBbUJqRSxZQUFjcUYsRUFBMEI4QyxRQUVwRTFGLE1BQU11RSxJQUNMaEQsRUFBYWhFLFlBQWNnSCxFQUFLcEUsS0FDaENxQixFQUFtQmpFLFlBQWNnSCxFQUFLbkUsTUFDdENpRSxFQUFXbEMsRUFBVSxJQUV0QkosTUFBTTlELFFBQVFnRSxPQUNkd0QsU0FBUSxLQUNQRixFQUFVaEksWUFBYyxNQUFNLEdBRXBDLElBeUhBMkUsRUFBa0IzRCxpQkFBaUIsU0FBUyxNRHRNckMsU0FBeUJ2QixFQUFhRSxHQUMzQyxNQUFNUyxFQUFZZ0ksTUFBTUMsS0FDdEI1SSxFQUFZMEcsaUJBQWlCeEcsRUFBT1QsZ0JBRWhDdUIsRUFBZ0JoQixFQUFZTSxjQUFjSixFQUFPUixzQkFFdkRpQixFQUFVOEQsU0FBU3hFLElBQ2pCRixFQUFlQyxFQUFhQyxFQUFjQyxFQUFPLElBR25EYSxFQUFrQkosRUFBV0ssRUFBZWQsRUFDOUMsQ0M0TEUySSxDQUFnQnpELEVBQWU3RixHQUMvQm9HLEVBQW9CK0MsTUFBUW5FLEVBQWFoRSxZQUN6Q3FGLEVBQTBCOEMsTUFBUWxFLEVBQW1CakUsWUFDckQyRyxFQUFVL0IsRUFBVSxJQUd0QkUsRUFBcUI5RCxpQkFBaUIsU0FBUyxLQUM3QzhGLEVBQVdsQyxFQUFVLElBR3ZCLE1BQU0yRCxFQUFvQmYsSUFDcEJBLEVBQUlDLE9BQU94SCxVQUFVeUgsU0FBUyxVQUNoQ1osRUFBV1UsRUFBSUMsT0FDakIsRUFPRixTQUFTWixFQUFlVyxHQUN0QixHQUFnQixXQUFaQSxFQUFJZ0IsSUFBa0IsQ0FDeEIsTUFBTUMsRUFBYzFILFNBQVNoQixjQUFjLGlCQUN2QzBJLEdBQ0YzQixFQUFXMkIsRUFFZixDQUNGLENEck5pQzlJLE1DME1qQ3VHLEVBQWtCaEMsU0FBUzBDLElBQ3pCQSxFQUFNNUYsaUJBQWlCLFFBQVN1SCxFQUFpQixJQVluRHJELEVBQWtCbEUsaUJBQWlCLFNBQVMsS0FDMUMyRixFQUFVNUIsRUFBWSxJQUd4QkksRUFBa0JuRSxpQkFBaUIsU0FBUyxLQUMxQzhGLEVBQVcvQixFQUFZLElBR3pCUyxFQUFjeEUsaUJBQWlCLFNBQVMsS0FDdEMyRixFQUFVcEIsRUFBVSxJQUd0QlUsRUFBa0JqRixpQkFBaUIsU0FBUyxLQUMxQzhGLEVBQVdoQixFQUFhLElBRzFCTCxFQUFxQnpFLGlCQUFpQixTQUFTLEtBQzdDOEYsRUFBV3ZCLEVBQVUsSUFHdkJlLEVBQVV0RixpQkFBaUIsU0FBUyxLQUNsQzhGLEVBQVdWLEVBQVksSUFHekJHLEVBQVV2RixpQkFBaUIsU0FBUyxLQUNsQzhGLEVBQVdWLEVBQVksSUFHekJJLEVBQWlCeEYsaUJBQWlCLFNBQVMsS0FDekM4RixFQUFXVixFQUFZLElBR3pCVixFQUFjMUUsaUJBQWlCLFVBekcvQixTQUEwQndHLEdBQ3hCQSxFQUFJTyxpQkFDSixNQUFNQyxFQUFZUixFQUFJUyxVQUN0QkQsRUFBVWhJLFlBQWMsWUFDeEI0QixFQUNHc0IsUUFBUSxDQUFFQyxLQUFNeUMsRUFBY3VDLE1BQU92RixLQUFNaUQsRUFBaUJzQyxRQUM1RDFGLE1BQU11RSxJQUNMLE1BQU01QyxFQUFjQyxFQUFlMkMsR0FDbkMxQyxFQUFVb0UsUUFBUXRFLEdBQ2xCc0IsRUFBY2lELFFBQ2QvSCxFQUFlK0UsRUFBa0IzRyxHQUNqQzhILEVBQVd2QixFQUFVLElBRXRCZixPQUFPQyxJQUNOL0QsUUFBUWdFLE1BQU1ELEVBQUksSUFFbkJ5RCxTQUFRLEtBQ1BGLEVBQVVoSSxZQUFjLE1BQU0sR0FFcEMsSUF3RkFnRixFQUFXaEUsaUJBQWlCLFVBdEY1QixTQUE0QndHLEdBQzFCQSxFQUFJTyxpQkFDSixNQUFNQyxFQUFZUixFQUFJUyxVQUN0QkQsRUFBVWhJLFlBQWMsWUFDeEIsTUFBTTRJLEVBQVkzRCxFQUFZa0QsTUFDOUJ2RyxFQUNHMkIsVUFBVXFGLEdBQ1ZuRyxNQUFNb0csSUFDTDVELEVBQVlrRCxNQUFRLEdBQ3BCakgsRUFBY0ksSUFBTXVILEVBQUlySCxPQUN4QnNGLEVBQVcvQixFQUFZLElBRXhCUCxPQUFPQyxJQUNOL0QsUUFBUWdFLE1BQU1ELEVBQUksSUFFbkJ5RCxTQUFRLEtBQ1BGLEVBQVVoSSxZQUFjLE1BQU0sR0FFcEMsSURyTGlDTCxFQzJQaEJYLEVEMVBFK0IsU0FBU29GLGlCQUFpQnhHLEVBQU9WLGNBQ3pDaUYsU0FBU3pFLElBL0JLcUosRUFBQ3JKLEVBQWFFLEtBQ3JDLE1BQU1TLEVBQVlnSSxNQUFNQyxLQUN0QjVJLEVBQVkwRyxpQkFBaUJ4RyxFQUFPVCxnQkFFaEN1QixFQUFnQmhCLEVBQVlNLGNBQWNKLEVBQU9SLHNCQUV2RHFCLEVBQWtCSixFQUFXSyxFQUFlZCxHQUU1Q1MsRUFBVThELFNBQVN4RSxJQUNqQkEsRUFBYXNCLGlCQUFpQixTQUFTLEtBM0NoQitILEVBQUN0SixFQUFhQyxFQUFjQyxLQUNoREQsRUFBYVksU0FBU0MsTUFRekJmLEVBQWVDLEVBQWFDLEVBQWNDLEdBeEJ2QnFKLEVBQUN2SixFQUFhQyxFQUFjdUosRUFBY3RKLEtBQy9ELE1BQU1DLEVBQWFGLEVBQWFHLEdBQUssU0FDYkosRUFBWU0sY0FBYyxJQUFNSCxHQUN4Q0ksWUFBY2lKLEVBQzlCdkosRUFBYU8sVUFBVWEsSUFBSW5CLEVBQU9MLGdCQUFnQixFQWFoRDBKLENBQ0V2SixFQUNBQyxFQUNBQSxFQUFhd0osa0JBQ2J2SixFQUlKLEVBa0NJb0osQ0FBbUJ0SixFQUFhQyxFQUFjQyxHQUM5Q2EsRUFBa0JKLEVBQVdLLEVBQWVkLEVBQU8sR0FDbkQsR0FDRixFQW1CQW1KLENBQWlCckosRUFBYUUsRUFBTyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtLS12YWxpZGF0ZVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiLFxuICBtb2RhbEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3NhdmUtYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfZXJyb3JfdHlwZVwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0lkID0gaW5wdXRFbGVtZW50LmlkICsgXCItZXJyb3JcIjtcbiAgY29uc3QgZXJyb3JNc2dFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTXNnSWQpO1xuICBlcnJvck1zZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnSWQgPSBpbnB1dEVsZW1lbnQuaWQgKyBcIi1lcnJvclwiO1xuICBjb25zdCBlcnJvck1zZ0VsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgZXJyb3JNc2dJZCk7XG4gIGVycm9yTXNnRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICBlcnJvck1zZ0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuZXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIGNvbmZpZ1xuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICB9KTtcbn07XG5cbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnNvbGUubG9nKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKTtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgZGlzYWJsZWRCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGRpc2FibGVkQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXIgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNldFZhbGlkYXRpb24oZm9ybUVsZW1lbnQsIGNvbmZpZykge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gIH0pO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbn1cblxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBzZXRFdmVudExpc3RlbmVyKGZvcm1FbGVtZW50LCBjb25maWcpO1xuICB9KTtcbn07XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IExvZ28gZnJvbSBcIi4uL2ltYWdlcy9Mb2dvLnN2Z1wiO1xuaW1wb3J0IGF2YXRhciBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcbmltcG9ydCBwZW5jaWwgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwuc3ZnXCI7XG5pbXBvcnQgcGx1cyBmcm9tIFwiLi4vaW1hZ2VzL3BsdXMuc3ZnXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcbmltcG9ydCBwaWMgZnJvbSBcIi4uL2ltYWdlcy9lZGl0LWF2YXRhci5zdmdcIjtcblxuaW1wb3J0IHtcbiAgZW5hYmxlVmFsaWRhdGlvbixcbiAgcmVzZXRWYWxpZGF0aW9uLFxuICBzZXR0aW5ncyxcbiAgZGlzYWJsZWRCdXR0b24sXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xuICBjb25zdCBoZWFkZXJMb2dvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2xvZ29cIik7XG4gIGNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcbiAgY29uc3QgZWRpdEJ1dHRvbkltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvbiBpbWdcIik7XG4gIGNvbnN0IG5ld1Bvc3RCdXR0b25JbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgXCIucHJvZmlsZV9fbmV3cG9zdC1idXR0b24gaW1nXCJcbiAgKTtcbiAgY29uc3QgZWRpdEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWVkaXRcIik7XG5cbiAgaGVhZGVyTG9nby5zcmMgPSBMb2dvO1xuICBwcm9maWxlQXZhdGFyLnNyYyA9IGF2YXRhcjtcbiAgZWRpdEJ1dHRvbkltYWdlLnNyYyA9IHBlbmNpbDtcbiAgbmV3UG9zdEJ1dHRvbkltYWdlLnNyYyA9IHBsdXM7XG4gIGVkaXRBdmF0YXIuc3JjID0gcGljO1xufSk7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLCB7XG4gIGF1dGhvcml6YXRpb246IFwiZjZjMWE5ZGEtZmM1NS00NGJiLWEzZmYtMWMzMWZhZThkZDg2XCIsXG59KTtcblxuYXBpXG4gIC5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFtjYXJkcywgdXNlckluZm9dKSA9PiB7XG4gICAgcHJvZmlsZVRpdGxlLnRleHRDb250ZW50ID0gdXNlckluZm8ubmFtZTtcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcbiAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXJJbmZvLmF2YXRhcjtcbiAgICBjb25zb2xlLmxvZyhbY2FyZHNdKTtcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmQpO1xuICAgICAgY2FyZHNMaXN0LmFwcGVuZChjYXJkRWxlbWVudCk7XG4gICAgfSk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9KTtcblxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XG5cbmNvbnN0IGVkaXRNb2RhbEZvcm0gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybS0tdmFsaWRhdGVcIik7XG5cbmNvbnN0IGVkaXRNb2RhbENsb3NlQnV0dG9uID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcblxuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xuXG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci1mb3JtXCIpO1xuXG5jb25zdCBhdmF0YXJJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItaW5wdXRcIik7XG5cbmNvbnN0IGF2YXRhck1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnRuXCIpO1xuXG5jb25zdCBhdmF0YXJDbG9zZUJ1dHRvbiA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcblxuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcblxuY29uc3QgZWRpdE1vZGFsVGl0bGVJbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5cbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5cbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5cbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5cbmNvbnN0IHBvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9zdC1tb2RhbFwiKTtcblxuY29uc3QgbmV3UG9zdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmV3cG9zdC1idXR0b25cIik7XG5cbmNvbnN0IHBvc3RNb2RhbENsb3NlQnV0dG9uID0gcG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcblxuY29uc3QgcG9zdE1vZGFsRm9ybSA9IHBvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtLS12YWxpZGF0ZVwiKTtcblxuY29uc3QgcG9zdFN1Ym1pdEJ1dHRvbiA9IHBvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiKTtcblxuY29uc3QgcG9zdExpbmtJbnB1dCA9IHBvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Bvc3QtbGluay1pbnB1dFwiKTtcblxuY29uc3QgcG9zdENhcHRpb25JbnB1dCA9IHBvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Bvc3QtY2FwdGlvbi1pbnB1dFwiKTtcblxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuXG5jb25zdCBwcmV2aWV3TW9kYWxJbWFnZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuXG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcblxuY29uc3QgbW9kYWxDbG9zZVByZXZpZXcgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX3ByZXZpZXdcIlxuKTtcblxuY29uc3QgbW9kYWxDbG9zZU92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xuXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xuXG5jb25zdCBkZWxldGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtZm9ybVwiKTtcblxuY29uc3QgYnRuRGVsZXRlID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uLWRlbGV0ZVwiKTtcblxuY29uc3QgYnRuQ2FuY2VsID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uLWNhbmNlbFwiKTtcblxuY29uc3QgY2xvc2VEZWxldGVNb2RhbCA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcblxubGV0IHNlbGVjdGVkQ2FyZCwgc2VsZWN0ZWRDYXJkSWQ7XG5cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NDbG9zZSk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjQ2xvc2UpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVFZGl0TW9kYWxGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgY29uc29sZS5sb2coc3VibWl0QnRuKTtcbiAgYXBpXG4gICAgLmVkaXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiBlZGl0TW9kYWxUaXRsZUlucHV0LnZhbHVlLFxuICAgICAgYWJvdXQ6IChwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlKSxcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBwcm9maWxlVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xuICAgICAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGNhcmRJZCkge1xuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcbiAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XG4gIG9wZW5Nb2RhbChkZWxldGVNb2RhbCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcblxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiRGVsZXRlXCI7XG4gICAgfSk7XG59XG5cbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICBjb25zdCBjYXJkSW1hZ2VFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gIGNvbnN0IGNhcmROYW1lRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICBjb25zdCBjYXJkTGlrZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gIGNvbnN0IGNhcmREZWxldGVCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XG5cbiAgY2FyZEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICBjYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XG4gIGNhcmROYW1lRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG5cbiAgaWYgKGRhdGEuaXNMaWtlZCkge1xuICAgIGNhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcbiAgfVxuXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiBoYW5kbGVMaWtlKGV2dCwgZGF0YS5faWQpKTtcblxuICBjYXJkRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YS5faWQpO1xuICB9KTtcblxuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICAgIHByZXZpZXdNb2RhbEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdNb2RhbEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdNb2RhbENhcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgfSk7XG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBoYW5kbGVMaWtlKGV2dCwgaWQpIHtcbiAgbGV0IGlzTGlrZWQgPSBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xuXG4gIGFwaVxuICAgIC5saWtlU3RhdHVzKGlkLCBpc0xpa2VkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGlmIChpc0xpa2VkKSB7XG4gICAgICAgIHJldHVybiBldnQudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xuICAgICAgfVxuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUG9zdFN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gIGFwaVxuICAgIC5uZXdDYXJkKHsgbGluazogcG9zdExpbmtJbnB1dC52YWx1ZSwgbmFtZTogcG9zdENhcHRpb25JbnB1dC52YWx1ZSB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGRhdGEpO1xuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICAgICAgcG9zdE1vZGFsRm9ybS5yZXNldCgpO1xuICAgICAgZGlzYWJsZWRCdXR0b24ocG9zdFN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xuICAgICAgY2xvc2VNb2RhbChwb3N0TW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xuICBzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICBjb25zdCBhdmF0YXJVcmwgPSBhdmF0YXJJbnB1dC52YWx1ZTtcbiAgYXBpXG4gICAgLm5ld0F2YXRhcihhdmF0YXJVcmwpXG4gICAgLnRoZW4oKHVybCkgPT4ge1xuICAgICAgYXZhdGFySW5wdXQudmFsdWUgPSBcIlwiO1xuICAgICAgcHJvZmlsZUF2YXRhci5zcmMgPSB1cmwuYXZhdGFyO1xuICAgICAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfSk7XG59XG5cbmVkaXRNb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0TW9kYWxGb3JtU3VibWl0KTtcblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcmVzZXRWYWxpZGF0aW9uKGVkaXRNb2RhbEZvcm0sIHNldHRpbmdzKTtcbiAgZWRpdE1vZGFsVGl0bGVJbnB1dC52YWx1ZSA9IHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudDtcbiAgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XG59KTtcblxuZWRpdE1vZGFsQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xufSk7XG5cbmNvbnN0IGhhbmRsZUNsb3NlTW9kYWwgPSAoZXZ0KSA9PiB7XG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XG4gICAgY2xvc2VNb2RhbChldnQudGFyZ2V0KTtcbiAgfVxufTtcblxubW9kYWxDbG9zZU92ZXJsYXkuZm9yRWFjaCgobW9kYWwpID0+IHtcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsb3NlTW9kYWwpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgaWYgKG9wZW5lZE1vZGFsKSB7XG4gICAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcbiAgICB9XG4gIH1cbn1cblxuYXZhdGFyTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKGF2YXRhck1vZGFsKTtcbn0pO1xuXG5hdmF0YXJDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcbn0pO1xuXG5uZXdQb3N0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChwb3N0TW9kYWwpO1xufSk7XG5cbm1vZGFsQ2xvc2VQcmV2aWV3LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcbn0pO1xuXG5wb3N0TW9kYWxDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKHBvc3RNb2RhbCk7XG59KTtcblxuYnRuRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xufSk7XG5cbmJ0bkNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcbn0pO1xuXG5jbG9zZURlbGV0ZU1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xufSk7XG5cbnBvc3RNb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVQb3N0U3VibWl0KTtcblxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoYmFzZVVybCwgaGVhZGVycykge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0QXBwSW5mbygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLmNoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuY2hlY2tSZXNwb25zZSk7XG4gIH1cbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogeyAuLi50aGlzLl9oZWFkZXJzLCBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5jaGVja1Jlc3BvbnNlKTtcbiAgfVxuICBuZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHsgLi4udGhpcy5faGVhZGVycywgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB7IC4uLnRoaXMuX2hlYWRlcnMsIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgfSkudGhlbih0aGlzLmNoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbGlrZVN0YXR1cyhpZCwgaXNMaWtlZCkge1xuICAgIGNvbnN0IG1ldGhvZCA9IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIjtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLmNoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbmV3QXZhdGFyKGF2YXRhcikge1xuICAgIGNvbnNvbGUubG9nKFwiU2VuZGluZyB0byBBUEk6XCIsIGF2YXRhcik7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogeyAuLi50aGlzLl9oZWFkZXJzLCBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBjaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJtb2RhbEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JNc2dJZCIsImlkIiwiZXJyb3JNc2dFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiaGFzSW52YWxpZElucHV0IiwiaW5wdXRMaXN0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImJ1dHRvbkVsZW1lbnQiLCJjb25zb2xlIiwibG9nIiwiZGlzYWJsZWRCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImhlYWRlckxvZ28iLCJwcm9maWxlQXZhdGFyIiwiZWRpdEJ1dHRvbkltYWdlIiwibmV3UG9zdEJ1dHRvbkltYWdlIiwiZWRpdEF2YXRhciIsInNyYyIsIkxvZ28iLCJhdmF0YXIiLCJwZW5jaWwiLCJwbHVzIiwicGljIiwiYXBpIiwiY29uc3RydWN0b3IiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsImNoZWNrUmVzcG9uc2UiLCJlZGl0VXNlckluZm8iLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm5ld0NhcmQiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsImxpa2VTdGF0dXMiLCJpc0xpa2VkIiwibmV3QXZhdGFyIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzIiwidXNlckluZm8iLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJmb3JFYWNoIiwiY2FyZCIsImNhcmRFbGVtZW50IiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkc0xpc3QiLCJhcHBlbmQiLCJjYXRjaCIsImVyciIsImVycm9yIiwicHJvZmlsZUVkaXRCdXR0b24iLCJlZGl0TW9kYWwiLCJlZGl0TW9kYWxGb3JtIiwiZWRpdE1vZGFsQ2xvc2VCdXR0b24iLCJhdmF0YXJNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJJbnB1dCIsImF2YXRhck1vZGFsQnV0dG9uIiwiYXZhdGFyQ2xvc2VCdXR0b24iLCJlZGl0TW9kYWxUaXRsZUlucHV0IiwiZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dCIsImNhcmRUZW1wbGF0ZSIsInBvc3RNb2RhbCIsIm5ld1Bvc3RCdXR0b24iLCJwb3N0TW9kYWxDbG9zZUJ1dHRvbiIsInBvc3RNb2RhbEZvcm0iLCJwb3N0U3VibWl0QnV0dG9uIiwicG9zdExpbmtJbnB1dCIsInBvc3RDYXB0aW9uSW5wdXQiLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3TW9kYWxJbWFnZUVsIiwicHJldmlld01vZGFsQ2FwdGlvbkVsIiwibW9kYWxDbG9zZVByZXZpZXciLCJtb2RhbENsb3NlT3ZlcmxheSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJidG5EZWxldGUiLCJidG5DYW5jZWwiLCJjbG9zZURlbGV0ZU1vZGFsIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImhhbmRsZUVzY0Nsb3NlIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJkYXRhIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRJbWFnZUVsIiwiY2FyZE5hbWVFbCIsImNhcmRMaWtlQnV0dG9uIiwiY2FyZERlbGV0ZUJ1dHRvbiIsImFsdCIsImV2dCIsInRhcmdldCIsImNvbnRhaW5zIiwiaGFuZGxlTGlrZSIsIl9pZCIsImNhcmRJZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdEJ0biIsInN1Ym1pdHRlciIsImZpbmFsbHkiLCJ2YWx1ZSIsIkFycmF5IiwiZnJvbSIsInJlc2V0VmFsaWRhdGlvbiIsImhhbmRsZUNsb3NlTW9kYWwiLCJrZXkiLCJvcGVuZWRNb2RhbCIsInByZXBlbmQiLCJyZXNldCIsImF2YXRhclVybCIsInVybCIsInNldEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==